<%- include('partials/head') %>

<!-- Store Hero Banner -->
<section class="store-hero">
    <div class="store-hero-bg"></div>
    <div class="store-hero-content">
        <div class="store-avatar-large">
            <span><%= seller.storeName.charAt(0).toUpperCase() %></span>
        </div>
        <div class="store-hero-info">
            <% if (seller.featured) { %>
                <span class="store-featured-badge">‚≠ê Featured Seller</span>
            <% } %>
            <h1><%= seller.storeName %></h1>
            <p class="store-owner">by <%= seller.name %></p>
            <div class="store-hero-stats">
                <div class="store-hero-stat">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path><line x1="3" y1="6" x2="21" y2="6"></line><path d="M16 10a4 4 0 0 1-8 0"></path></svg>
                    <span><strong><%= stats.totalProducts %></strong> Products</span>
                </div>
                <% if (seller.phone) { %>
                <div class="store-hero-stat">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg>
                    <span><%= seller.phone %></span>
                </div>
                <% } %>
                <div class="store-hero-stat">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
                    <span>Joined <%= new Date(seller.createdAt).toLocaleDateString('en-US', { month: 'short', year: 'numeric' }) %></span>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Category Filter Tabs -->
<section class="store-categories-nav">
    <div class="store-container">
        <div class="category-tabs">
            <a href="/store/<%= seller._id %>" class="category-tab <%= !category ? 'active' : '' %>">
                <span class="tab-label">All</span>
                <span class="tab-count"><%= stats.totalProducts %></span>
            </a>
            <a href="/store/<%= seller._id %>?category=rackets<%= sort ? '&sort=' + sort : '' %>" class="category-tab <%= category === 'rackets' ? 'active' : '' %>">
                <span class="tab-icon">üè∏</span>
                <span class="tab-label">Rackets</span>
                <span class="tab-count"><%= stats.rackets %></span>
            </a>
            <a href="/store/<%= seller._id %>?category=shoes<%= sort ? '&sort=' + sort : '' %>" class="category-tab <%= category === 'shoes' ? 'active' : '' %>">
                <span class="tab-icon">üëü</span>
                <span class="tab-label">Shoes</span>
                <span class="tab-count"><%= stats.shoes %></span>
            </a>
            <a href="/store/<%= seller._id %>?category=accessories<%= sort ? '&sort=' + sort : '' %>" class="category-tab <%= category === 'accessories' ? 'active' : '' %>">
                <span class="tab-icon">üéí</span>
                <span class="tab-label">Accessories</span>
                <span class="tab-count"><%= stats.accessories %></span>
            </a>
        </div>
    </div>
</section>

<!-- Products Section -->
<section class="store-products">
    <div class="store-container">
        <div class="store-products-header">
            <div class="store-results-info">
                <h2>
                    <% if (category) { %>
                        <%= category.charAt(0).toUpperCase() + category.slice(1) %>
                    <% } else { %>
                        All Products
                    <% } %>
                </h2>
                <p><%= products.length %> product<%= products.length !== 1 ? 's' : '' %> found</p>
            </div>
            <div class="store-sort">
                <label for="store-sort-select">Sort by:</label>
                <select id="store-sort-select" onchange="applyStoreSort(this.value)">
                    <option value="" <%= !sort ? 'selected' : '' %>>Newest</option>
                    <option value="featured" <%= sort === 'featured' ? 'selected' : '' %>>Featured</option>
                    <option value="name_asc" <%= sort === 'name_asc' ? 'selected' : '' %>>Name: A-Z</option>
                    <option value="name_desc" <%= sort === 'name_desc' ? 'selected' : '' %>>Name: Z-A</option>
                    <option value="price_asc" <%= sort === 'price_asc' ? 'selected' : '' %>>Price: Low to High</option>
                    <option value="price_desc" <%= sort === 'price_desc' ? 'selected' : '' %>>Price: High to Low</option>
                </select>
            </div>
        </div>
        
        <% if (products.length > 0) { %>
            <div class="products-grid">
                <% products.forEach(product => { %>
                    <%- include('partials/product-card', { product }) %>
                <% }) %>
            </div>
        <% } else { %>
            <div class="store-empty">
                <div class="store-empty-icon">üì¶</div>
                <h3>No products found</h3>
                <% if (category) { %>
                    <p>This store doesn't have any <%= category %> yet.</p>
                    <a href="/store/<%= seller._id %>" class="btn btn-outline">View All Products</a>
                <% } else { %>
                    <p>This store doesn't have any products yet.</p>
                    <a href="/products" class="btn btn-primary">Browse All Products</a>
                <% } %>
            </div>
        <% } %>
    </div>
</section>

<!-- Store Info Card -->

<script>
    function applyStoreSort(sortValue) {
        const url = new URL(window.location.href);
        if (sortValue) {
            url.searchParams.set('sort', sortValue);
        } else {
            url.searchParams.delete('sort');
        }
        window.location.href = url.toString();
    }
</script>

<%- include('partials/tail') %>
